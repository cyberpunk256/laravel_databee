import{L as s}from"./leaflet-src-17579372.js";import{P as w}from"./gpx-f365e077.js";import{T as y}from"./ThreeVideoPlayer-511ab330.js";import{_ as V}from"./_plugin-vue_export-helper-c27b6911.js";import{o as d,B as k,c as i,w as n,b as l,m as p,n as u,s as _,A as m,a as c,z as x,v as g}from"./app-189fa0bd.js";const B={components:{ThreeVideoPlayer:y,Panorama:w},props:["record"],data(){return{map:null,map_default_option:{view:[0,0],pin:[0,0],zoom:1},modal:!1,modal_video_url:null,modal_image_url:null,gpxOptions:{async:!0,marker_options:{startIconUrl:!1,endIconUrl:!1,shadowUrl:!1},gpx_options:{joinTrackSegments:!1},polyline_options:{color:"red",weight:5,opacity:.7,lineCap:"round"}}}},mounted(){const o=this;if(o.map_default_option=this.constant.map,o.map=s.map("map").setView(o.map_default_option.view,o.map_default_option.zoom),s.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>'}).addTo(o.map),o.record.type==1){const t=o.get_path_url(o.record.gpx_path);new s.GPX(t,this.gpxOptions).on("loaded",o.onLoaded).on("click",function(){o.onShowModal()})}else if(o.record.type==2||o.record.type==3){const t=o.record.image_lat&&o.record.image_long?[o.record.image_lat,o.record.image_long]:this.map_default_option.pin,r=s.marker(t,{draggable:!0}).addTo(o.map).on("click",function(){o.onShowModal()});r.on("dragstart",function(f){}),r.on("dragend",function(f){var e=r.getLatLng();o.$emit("update",e)})}},methods:{onLoaded(o){this.map.fitBounds(o.target.getBounds()),o.target.addTo(this.map)},onShowModal(){this.record.type==1?(this.modal_video_url=this.record.video_path,this.modal=!0):(this.modal_image_url=this.get_path_url(this.record.image_path),this.modal=!0)}}},C=c("div",{id:"map",class:"admin_map"},null,-1),L={class:"vp_content"},M={class:"vp_content"};function T(o,t,r,f,e,U){const h=g("three-video-player"),v=g("panorama");return d(),k("div",null,[C,r.record.type==1&&e.modal_video_url?(d(),i(_,{key:0,modelValue:e.modal,"onUpdate:modelValue":t[1]||(t[1]=a=>e.modal=a),width:"auto"},{default:n(()=>[l(u,{class:"vp_card"},{default:n(()=>[l(p,{icon:"mdi-close",onClick:t[0]||(t[0]=a=>e.modal=!1),class:"vp_close"}),l(h,{url:e.modal_video_url},null,8,["url"])]),_:1})]),_:1},8,["modelValue"])):m("",!0),r.record.type==2&&e.modal_image_url?(d(),i(_,{key:1,modelValue:e.modal,"onUpdate:modelValue":t[3]||(t[3]=a=>e.modal=a),width:"auto"},{default:n(()=>[l(u,{class:"vp_card"},{default:n(()=>[l(p,{icon:"mdi-close",onClick:t[2]||(t[2]=a=>e.modal=!1),class:"vp_close"}),c("div",L,[l(x,{width:"auto","max-width":"1200",contain:"",src:e.modal_image_url},null,8,["src"])])]),_:1})]),_:1},8,["modelValue"])):m("",!0),r.record.type==3&&e.modal_image_url?(d(),i(_,{key:2,modelValue:e.modal,"onUpdate:modelValue":t[5]||(t[5]=a=>e.modal=a),width:"auto"},{default:n(()=>[l(u,{class:"vp_card"},{default:n(()=>[l(p,{icon:"mdi-close",onClick:t[4]||(t[4]=a=>e.modal=!1),class:"vp_close"}),c("div",M,[e.modal?(d(),i(v,{key:0,url:e.modal_image_url},null,8,["url"])):m("",!0)])]),_:1})]),_:1},8,["modelValue"])):m("",!0)])}const N=V(B,[["render",T]]);export{N as default};
