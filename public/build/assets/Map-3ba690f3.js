import{L as i,o as s,A as k,c as d,w as m,b as l,m as _,n as g,s as f,C as c,a as h,z as w,v}from"./app-b42772e3.js";import{P as V}from"./Panorama-ff94029f.js";import{T as x}from"./ThreeVideoPlayer-fee0db93.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";const C={components:{ThreeVideoPlayer:x,Panorama:V},props:["record"],data(){return{map:null,map_default_option:{view:[0,0],pin:[0,0],zoom:1},modal:!1,modal_video_url:null,modal_image_url:null,gpxOptions:{async:!0,marker_options:{startIconUrl:!1,endIconUrl:!1,shadowUrl:!1},gpx_options:{joinTrackSegments:!1},polyline_options:{color:"blue",weight:10,opacity:1,lineCap:"round"}}}},mounted(){const o=this,t={maxZoom:o.constant.map.max_zoom};console.log("constant",o.constant),o.gpxOptions.polyline_options.weight=o.getLineWeightByZoom(o.constant.map.zoom,o.constant.map.gpx.weight);const r=o.getMarkerSizeByZoom(o.constant.map.zoom,o.constant.map.marker.size),y=i.icon({iconUrl:this.constant.map.marker.icon,iconSize:[r,r]}),e=i.map("map",t).setView(o.constant.map.view,o.constant.map.zoom).on("zoomend",o.onZoomChange);if(i.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>',maxZoom:o.constant.map.max_zoom}).addTo(e),o.record.type==1){const p=o.get_path_url(o.record.gpx_path);new i.GPX(p,this.gpxOptions).on("loaded",function(n){e.fitBounds(n.target.getBounds())}).addTo(e).on("click",function(){o.onShowModal()})}else if(o.record.type==2||o.record.type==3){const p=o.record.image_lat&&o.record.image_long?[o.record.image_lat,o.record.image_long]:o.constant.map.init_pos,n=i.marker(p,{icon:y,draggable:!0}).addTo(e).on("click",function(){o.onShowModal()});n.on("dragstart",function(u){}),n.on("dragend",function(u){var a=n.getLatLng();o.$emit("update",a)})}},methods:{onLoaded(o){},onShowModal(){this.record.type==1?(this.modal_video_url=this.record.video_path,this.modal=!0):(this.modal_image_url=this.get_path_url(this.record.image_path),this.modal=!0)}}},B=h("div",{id:"map",class:"admin_map"},null,-1),P={class:"vp_content"},S={class:"vp_content"};function T(o,t,r,y,e,p){const n=v("ThreeVideoPlayer"),u=v("Panorama");return s(),k("div",null,[B,r.record.type==1&&e.modal_video_url?(s(),d(f,{key:0,modelValue:e.modal,"onUpdate:modelValue":t[1]||(t[1]=a=>e.modal=a),width:"auto"},{default:m(()=>[l(g,{class:"vp_card"},{default:m(()=>[l(_,{icon:"mdi-close",class:"vp_close",onClick:t[0]||(t[0]=a=>e.modal=!1)}),l(n,{url:e.modal_video_url},null,8,["url"])]),_:1})]),_:1},8,["modelValue"])):c("",!0),r.record.type==2&&e.modal_image_url?(s(),d(f,{key:1,modelValue:e.modal,"onUpdate:modelValue":t[3]||(t[3]=a=>e.modal=a),width:"auto"},{default:m(()=>[l(g,{class:"vp_card"},{default:m(()=>[l(_,{icon:"mdi-close",class:"vp_close",onClick:t[2]||(t[2]=a=>e.modal=!1)}),h("div",P,[e.modal?(s(),d(w,{key:0,"lazy-src":"/empty.png","max-width":"1000",src:e.modal_image_url},null,8,["src"])):c("",!0)])]),_:1})]),_:1},8,["modelValue"])):c("",!0),r.record.type==3&&e.modal_image_url?(s(),d(f,{key:2,modelValue:e.modal,"onUpdate:modelValue":t[5]||(t[5]=a=>e.modal=a),width:"auto"},{default:m(()=>[l(g,{class:"vp_card"},{default:m(()=>[l(_,{icon:"mdi-close",class:"vp_close",onClick:t[4]||(t[4]=a=>e.modal=!1)}),h("div",S,[e.modal?(s(),d(u,{key:0,url:e.modal_image_url},null,8,["url"])):c("",!0)])]),_:1})]),_:1},8,["modelValue"])):c("",!0)])}const b=z(C,[["render",T]]);export{b as default};
