import{L as i,o as n,B as k,c as m,w as r,b as l,m as c,n as u,s as _,A as d,a as g,z as w,v as h}from"./app-7cd9a6a1.js";import{P as V}from"./gpx-b1a0f0ad.js";import{T as x}from"./ThreeVideoPlayer-642d4d84.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";const B={components:{ThreeVideoPlayer:x,Panorama:V},props:["record"],data(){return{map:null,map_default_option:{view:[0,0],pin:[0,0],zoom:1},modal:!1,modal_video_url:null,modal_image_url:null,gpxOptions:{async:!0,marker_options:{startIconUrl:!1,endIconUrl:!1,shadowUrl:!1},gpx_options:{joinTrackSegments:!1},polyline_options:{color:"blue",weight:10,opacity:1,lineCap:"round"}}}},mounted(){const o=this;o.gpxOptions.polyline_options.weight=o.getLineWeightByZoom(this.constant.map.zoom,this.constant.map.gpx.weight);const t=o.getMarkerSizeByZoom(o.constant.map.zoom,o.constant.map.marker.size),s=i.icon({iconUrl:this.constant.map.marker.icon,iconSize:[t,t]});if(o.map=i.map("map").setView(o.constant.map.view,o.constant.map.zoom).on("zoomend",o.onZoomChange),i.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>'}).addTo(o.map),o.record.type==1){const p=o.get_path_url(o.record.gpx_path);new i.GPX(p,this.gpxOptions).on("loaded",o.onLoaded).on("click",function(){o.onShowModal()})}else if(o.record.type==2||o.record.type==3){const p=o.record.image_lat&&o.record.image_long?[o.record.image_lat,o.record.image_long]:o.constant.map.pin;o.marker=i.marker(p,{icon:s,draggable:!0}).addTo(o.map).on("click",function(){o.onShowModal()}),o.marker.on("dragstart",function(e){}),o.marker.on("dragend",function(e){var f=o.marker.getLatLng();o.$emit("update",f)})}},methods:{onLoaded(o){this.map.fitBounds(o.target.getBounds()),o.target.addTo(this.map)},onShowModal(){this.record.type==1?(this.modal_video_url=this.record.video_path,this.modal=!0):(this.modal_image_url=this.get_path_url(this.record.image_path),this.modal=!0)}}},C=g("div",{id:"map",class:"admin_map"},null,-1),S={class:"vp_content"},L={class:"vp_content"};function M(o,t,s,p,e,f){const v=h("three-video-player"),y=h("panorama");return n(),k("div",null,[C,s.record.type==1&&e.modal_video_url?(n(),m(_,{key:0,modelValue:e.modal,"onUpdate:modelValue":t[1]||(t[1]=a=>e.modal=a),width:"auto"},{default:r(()=>[l(u,{class:"vp_card"},{default:r(()=>[l(c,{icon:"mdi-close",onClick:t[0]||(t[0]=a=>e.modal=!1),class:"vp_close"}),l(v,{url:e.modal_video_url},null,8,["url"])]),_:1})]),_:1},8,["modelValue"])):d("",!0),s.record.type==2&&e.modal_image_url?(n(),m(_,{key:1,modelValue:e.modal,"onUpdate:modelValue":t[3]||(t[3]=a=>e.modal=a),width:"auto"},{default:r(()=>[l(u,{class:"vp_card"},{default:r(()=>[l(c,{icon:"mdi-close",onClick:t[2]||(t[2]=a=>e.modal=!1),class:"vp_close"}),g("div",S,[e.modal?(n(),m(w,{key:0,"lazy-src":"/empty.png","max-width":"1000",src:e.modal_image_url},null,8,["src"])):d("",!0)])]),_:1})]),_:1},8,["modelValue"])):d("",!0),s.record.type==3&&e.modal_image_url?(n(),m(_,{key:2,modelValue:e.modal,"onUpdate:modelValue":t[5]||(t[5]=a=>e.modal=a),width:"auto"},{default:r(()=>[l(u,{class:"vp_card"},{default:r(()=>[l(c,{icon:"mdi-close",onClick:t[4]||(t[4]=a=>e.modal=!1),class:"vp_close"}),g("div",L,[e.modal?(n(),m(y,{key:0,url:e.modal_image_url},null,8,["url"])):d("",!0)])]),_:1})]),_:1},8,["modelValue"])):d("",!0)])}const O=z(B,[["render",M]]);export{O as default};
